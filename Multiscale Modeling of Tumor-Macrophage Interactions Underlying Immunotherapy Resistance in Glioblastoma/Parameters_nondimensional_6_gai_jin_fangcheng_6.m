%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Original parameters
D_T=1.0*10^(-9);  %Rate of diffusion of tumor cells
D_M1=1.0*10^(-9);   %Rate of diffusion of M1 macrophages
D_M2=1.0*10^(-9); %Rate of diffusion of M2 macrophages
r_T_0=2.41*10^(-7);  %Basic growth rate of tumor cells
d_T_0=2.8660*1e-9;  %Baseline death rate of tumor cells
a_T_EGF=1.7*10^(-3); %Chemotaxis coefficient of tumor cells towards EGF
a_T_IGF1=1.7*10^(-3); %Chemotaxis coefficient of tumor cells towards IGF1
a_M1=a_T_IGF1;%Chemotaxis coefficient of M1 macrophages towards CSF1
a_M2=a_T_IGF1;%Chemotaxis coefficient of M2 macrophages towards CSF1
D_CSF1=2.0*10^(-6);  %Diffusion rate of CSF1
D_EGF=2.0*10^(-6);                      %Diffusion rate of EGF
D_IGF1=2.0*10^(-6);                      %iffusion rate of IGF1
S_CSF1=3.20*10^(-22);  % gs-1cell-1      %Secretion rate of CSF1 by tumor cells
S_EGF=2.88*10^(-22);  % gs-1cell-1      %Secretion rate of EGF by M2 macrophages
S_IGF1=1.92*10^(-22);  % gs-1cell-1      %Secretion rate of IGF1 by M2 macrophages
d_CSF1=5.0*10^(-4); %Degradation rate of CSF1
d_EGF=2.5*10^(-4); %Degradation rate of EGF
d_IGF1=2.5*10^(-4); %Degradation rate of IGF1
S_A=1.2905*10^(-7)*3;%Rate of accumulation of drug-resistant cell factors produced by CSF1_R_I
D_drug=2.0*10^(-6);%Diffusion rate of Drug
eta_drug=8.02*10^(-6); %Degradation rate of the drug

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Scaling parameters
t_s=D_IGF1/(d_IGF1*D_T);  
x_0=sqrt(D_IGF1/d_IGF1);  
C_T_max=1.0*10^9;
C_M1_max=2.0*10^8;
C_M2_max=2.0*10^8;
CSF1_s=S_CSF1/d_CSF1*C_T_max;
EGF_s=S_IGF1/d_IGF1*C_M1_max;
IGF1_s=S_IGF1/d_IGF1*C_M1_max;
CSF1_max=1;
CSF1_max_0=CSF1_max*CSF1_s;
EGF_max=1;
EGF_max_0=EGF_max*EGF_s;
IGF1_max=1;
IGF1_max_0=IGF1_max*IGF1_s;

A_T_EGF=a_T_EGF/D_T*S_IGF1*C_M1_max/d_IGF1;
A_T_IGF1=a_T_IGF1/D_T*S_IGF1*C_M1_max/d_IGF1;
A_M1=a_M1/D_M1*S_CSF1/d_CSF1*C_T_max;
A_M2=a_M2/D_M2*S_CSF1/d_CSF1*C_T_max;
B_1=d_CSF1/d_IGF1;
B_2=1.5;
B_3=t_s*S_A;
epsilon=D_T/D_IGF1;
D_d=D_drug*t_s/x_0^2;
eta_d=eta_drug*t_s;
r_T=r_T_0*(D_IGF1/d_IGF1/D_T);
d_T=d_T_0*(D_IGF1/d_IGF1/D_T);
a_ERK_old=20;
a_AKT_old=a_ERK_old*0.3;
k_r=2.5;
k_r_0=k_r/C_M2_max;
d_TM1_old=1.3*a_ERK_old*r_T/d_T/2;
a_M2M1_old=10;
a_CSF1_old=a_M2M1_old*2.5;
a_A=a_M2M1_old*8;
K1=0.5;
K2=0.5;
K31=0.3;
K31_0=K31*CSF1_s;
K32=10*3;
K32_0=K32*CSF1_s;
K4=30;

A_0=0; 
a_M2M1=a_M2M1_old*1.4400;
a_M2M1_0=a_M2M1/(D_IGF1/d_IGF1/D_T);
a_CSF1=a_CSF1_old*5;
a_CSF1_0=a_CSF1/(D_IGF1/d_IGF1/D_T);
a_ERK=a_ERK_old*0.65*1.1;
a_AKT=a_AKT_old/0.3*2.2;
d_TM1=d_TM1_old*1.3;
d_TM1_0=d_TM1/C_M1_max;

load('canshu1-24hours-ode15s.mat','p');
Ptest1=p(1,1:22);
V7_0=Ptest1(1);
a_0=Ptest1(2);
V81=Ptest1(3);
V82=Ptest1(4);
V9_0=Ptest1(5);
V10_0=Ptest1(6);
d7_0=Ptest1(7);
d8_0=Ptest1(8);
d9_0=Ptest1(9);
d10_0=Ptest1(10);
K71=Ptest1(11);
K72=Ptest1(12);
K81=Ptest1(13);
K82=Ptest1(14);
K83=Ptest1(15);
K91=Ptest1(16);
K92=Ptest1(17);
K101=Ptest1(18);
K102=Ptest1(19);
K73=Ptest1(20);
K93=Ptest1(21);
n=floor(Ptest1(22));
V7=V7_0*t_s;
a=a_0*t_s;
V9=V9_0*t_s;
V10=V10_0*t_s;
K71_0=K71*EGF_s;
K91_0=K91*IGF1_s;
d7=d7_0*t_s;
d8=d8_0*t_s;
d9=d9_0*t_s;
d10=d10_0*t_s;

a_A_0=a_A/(D_IGF1/d_IGF1/D_T);